<!DOCTYPE html>
<html>
<head>
    <title>Вход - {% if vulnerable %}Уязвимая{% else %}Безопасная{% endif %} версия</title>
</head>
<body>
    <h2>Вход ({% if vulnerable %}УЯЗВИМАЯ{% else %}БЕЗОПАСНАЯ{% endif %} версия)</h2>
    
    {% with messages = get_flashed_messages() %}
        {% if messages %}
            <div class="flashes">
                {% for message in messages %}
                    <div class="flash">{{ message }}</div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}
    
    <form method="POST">
        {{ form.csrf_token }}
        <p>
            {{ form.username.label }}<br>
            {{ form.username(size=32) }}
        </p>
        <p>
            {{ form.password.label }}<br>
            {{ form.password(size=32) }}
        </p>
        <p>{{ form.submit() }}</p>
    </form>
    
    {% if vulnerable %}
        <p><a href="{{ url_for('register_vulnerable') }}">Регистрация</a></p>
        <p><em>Эта версия уязвима к SQL-инъекциям!</em></p>
    {% else %}
        <p><a href="{{ url_for('register_secure') }}">Регистрация</a></p>
    {% endif %}
    
    <p><a href="{{ url_for('index') }}">На главную</a></p>
</body>
</html>